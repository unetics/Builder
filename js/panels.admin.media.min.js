jQuery(function($){if("undefined"!=typeof wp&&wp.media&&wp.media.editor){var e=wp.media.editor.insert;wp.media.editor.insert=function(a){if(!$("#wp-content-wrap").hasClass("panels-active"))return e(a);if($(".panel-dialog:visible").length>0)return e(a);if(-1!==a.indexOf("[gallery")){var n=wp.media.gallery.attachments(wp.shortcode.next("gallery",a).shortcode),i=n.models.map(function(e){return e.id}),l=$("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Gallery",{ids:i.join(",")});return void(null==l?e(a):panels.addPanel(l,null,null,!0))}if(-1!==a.indexOf("<a ")||-1!==a.indexOf("<img ")){var t=$(a),l;return"A"==t.prop("tagName")&&"IMG"==t.children().eq(0).prop("tagName")?l=$("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Image",{href:t.attr("href"),src:t.children().eq(0).attr("src")}):"IMG"==t.prop("tagName")?l=$("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Image",{src:t.attr("src")}):"A"!=t.prop("tagName")||-1===t.attr("href").indexOf(".mp4")&&-1===t.attr("href").indexOf(".avi")||(l=$("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Video",{url:t.attr("href")})),void(null==l?e(a):panels.addPanel(l,null,null,!0))}var l=$("#panels-dialog").panelsCreatePanel("WP_Widget_Text",{text:a});null==l?e(a):panels.addPanel(l,null,null,!0),e(a)}}}),jQuery(function($){$("body").on({click:function(e){if("undefined"!=typeof wp&&wp.media&&wp.media.gallery){e.preventDefault();var a=$(this),n=$(".panels-admin-dialog:visible"),i=n.find('*[name$="[ids]"]').val();(0===i.indexOf("{demo")||0===i.indexOf("{default"))&&(i="-"),""===i&&null===$("#post_ID").val()&&(i="-");var l=wp.media.gallery.edit('[gallery ids="'+i+'"]');return l.state("gallery-edit").on("update",function(e){var a=e.models.map(function(e){return e.id});n.find('input[name$="[ids]"]').val(a.join(","))}),l.on("escape",function(){n.find(".ui-dialog-content").dialog("open")}),!1}}},".so-gallery-widget-select-attachments")});